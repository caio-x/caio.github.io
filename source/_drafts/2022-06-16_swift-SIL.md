---
title: Swift - SIL
date: 2022-06-16
tags: [Swift]
categories: Swift
---


## Swift 编译流程

## SIL概要

在Swift源码的官方文档中是这么写的
> Swift Intermediate Language (SIL). SIL is an SSA-form IR with high-level semantic information designed to implement
the Swift programming language.

简单的来说(翻译)：SIL是一种携带高级语法信息的SSA格式的IR，会参与Swift语言的实现。

IR(Intermediate Representation)可以理解，是llvm三段式编译的中间产物，那SSA是什么？

### SSA 概要

SSA(Static single assignment) - 静态单赋值形式。在编译器设计中，SSA是一种IR的设计特性，**每个变量只会被赋值一次**。

SSA的作用是用来这种简化变量的方式，来简化改进编译器优化的结果。举个例子：

```
 y := 1
 y := 2
 x := y
```

从优化的角度来说，第一行代码是不必要的，为了让编译器更简单地识别出这种场景，在SSA下，这个IR就会变成下面这种形式。

```
 y1 := 1
 y2 := 2
 x1 := y2
```

编译器可以通过一些可达性的分析，来测定和优化。除了可以做上面这种，消除无用代码的改进，借助SSA还可以做到很多其他的改进，详细的可以看[维基百科](https://zh.wikipedia.org/wiki/%E9%9D%99%E6%80%81%E5%8D%95%E8%B5%8B%E5%80%BC%E5%BD%A2%E5%BC%8F)

φ函数